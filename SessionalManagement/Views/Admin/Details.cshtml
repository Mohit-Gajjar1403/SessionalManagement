@model SessionalManagement.Models.TeacherSubjectViewModel

@{
    ViewData["Title"] = "Teachers & Subjects";
}

<h2>Teachers</h2>

@foreach (var t in Model.Teachers)
{
    <div class="card mb-3">
        <div class="card-header d-flex justify-content-between align-items-center">
            <div>
                <span class="h5 mb-0">@t.Name</span>
                <span class="text-muted ms-2">@t.Email</span>
            </div>
            <a asp-action="EditTeacher" asp-route-id="@t.Id" class="btn btn-sm btn-primary">Edit</a>
        </div>
        <div class="card-body py-2">
            @{
                var subjects = t.TeacherSubjects.Select(s => s.Subject.Name).ToList();
            }

            @if (subjects.Count == 0)
            {
                <div class="text-muted">No subjects assigned.</div>
            }
            else
            {
                <ul class="mb-0">
                    @foreach (var s in subjects)
                    {
                        <li>@s</li>
                    }
                </ul>
            }
        </div>
    </div>
}

<h2 class="mt-5">All Subjects</h2>
<table class="table table-bordered">
    <thead>
        <tr>
            <th>Code</th>
            <th>Semester</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var s in Model.Subjects)
        {
            <tr>
                <td>@s.Name</td>
                <td>@s.Semester</td>
            </tr>
        }
    </tbody>
</table>

@if (Model.EditTeacher != null)
{
    <hr />
    <h3>Edit Teacher</h3>
    <form asp-action="EditTeacher" method="post">
        <input type="hidden" asp-for="EditTeacher.Id" />
        <div class="mb-3">
            <label asp-for="EditTeacher.Name" class="form-label"></label>
            <input asp-for="EditTeacher.Name" class="form-control" />
            <span asp-validation-for="EditTeacher.Name" class="text-danger"></span>
        </div>
        <div class="mb-3">
            <label asp-for="EditTeacher.Email" class="form-label"></label>
            <input asp-for="EditTeacher.Email" class="form-control" />
            <span asp-validation-for="EditTeacher.Email" class="text-danger"></span>
        </div>
        <button type="submit" class="btn btn-success">Save</button>
        <a asp-action="Teachers" class="btn btn-secondary">Cancel</a>
    </form>
}
